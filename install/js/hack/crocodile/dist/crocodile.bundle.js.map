{"version":3,"file":"crocodile.bundle.js","sources":["../src/crocodile.js"],"sourcesContent":["import {Type, Loc, Tag} from 'main.core';\nimport {Popup} from 'main.popup';\nimport { BitrixVue } from 'ui.vue3';\nimport './crocodile.css';\n\nexport class CrocodileApplication\n{\n\tconstructor(options = {})\n\t{\n\t\tif (Type.isStringFilled(options.rootNodeId))\n\t\t{\n\t\t\tthis.rootNode = document.getElementById(options.rootNodeId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthrow new Error('CrocodileApplication: options.rootNodeId required')\n\t\t}\n\t}\n\n\tstart()\n\t{\n\t\tthis.attachTemplate();\n\t}\n\n\tattachTemplate()\n\t{\n\t\tBitrixVue.createApp({\n\t\t\tdata() {\n\t\t\t\treturn {\n\t\t\t\t\tchat: [],\n\t\t\t\t\tartistName: 'Художник',\n\t\t\t\t\troomId: null,\n\t\t\t\t\tuserId: null,\n\t\t\t\t\tisArtist: false,\n\t\t\t\t\tword: 'рекурсия',\n\t\t\t\t\timagePath: null,\n\t\t\t\t\tmessage: '',\n\n\t\t\t\t\ttool: 'brush',\n\t\t\t\t\tcolor: 'black',\n\t\t\t\t\tsize: 5,\n\t\t\t\t\tctx: null\n\t\t\t\t}\n\t\t\t},\n\t\t\tmounted()\n\t\t\t{\n\t\t\t\tBX.PULL.subscribe({\n\t\t\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\t\t\tmoduleId: 'hack.crocodile',\n\t\t\t\t\tcallback: this.handlePullEvent\n\t\t\t\t});\n\t\t\t\tBX.ajax.runAction('hack:crocodile.CrocodileController.getRoom').then(response => {\n\t\t\t\t\tthis.artistName = response.data.artistName;\n\t\t\t\t\tthis.roomId = response.data.roomId;\n\t\t\t\t\tthis.userId = response.data.userId;\n\t\t\t\t\tthis.userName = response.data.userName;\n\t\t\t\t\tthis.isArtist = response.data.isArtist;\n\t\t\t\t\tthis.word = response.data.word;\n\t\t\t\t\tthis.imagePath = response.data.imagePath;\n\n\t\t\t\t\tif (this.isArtist)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.popupWindow = new Popup(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twidth: 300,\n\t\t\t\t\t\t\t\theight: 200,\n\t\t\t\t\t\t\t\tcontent: Tag.render`<div>Вы хотите быть художником?</div>`,\n\t\t\t\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\t\t\t\ttext: 'да',\n\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.popupWindow.close();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\t\t\t\ttext: 'нет',\n\t\t\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\t\t\t\tBX.ajax.runAction('hack:crocodile.CrocodileController.changePainter', {\n\t\t\t\t\t\t\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\troomId: this.roomId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.popupWindow.show();\n\t\t\t\t\t}\n\n\t\t\t\t\tBX.ajax.runAction('hack:crocodile.CrocodileController.getChat',{\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\troomId: this.roomId\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(r => {\n\t\t\t\t\t\tthis.chat = r.data;\n\t\t\t\t\t\tif (this.$refs.crocodileChat)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$refs.crocodileChat.scrollTop = this.$refs.crocodileChat.scrollHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.ctx = this.$refs.crocodileCanvas.getContext(\"2d\");\n\t\t\t\t\tfetch('/getCrocodileImage', {method: \"GET\"})\n\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\treturn response.json();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then((img) => {\n\t\t\t\t\t\t\tconst image = new Image();\n\t\t\t\t\t\t\timage.onload = () => {\n\t\t\t\t\t\t\t\tthis.ctx.drawImage(image, 0, 0);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\timage.src = img;\n\t\t\t\t\t\t})\n\n\t\t\t\t\tthis.ctx.strokeStyle = \"#000000\";\n\t\t\t\t\tthis.ctx.lineCap = \"round\";\n\t\t\t\t\tthis.ctx.lineWidth = 4;\n\n\t\t\t\t\tthis.$refs.crocodileCanvas.onmousemove = (e) => {\n\t\t\t\t\t\tif (this.isArtist)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst x = e.offsetX;\n\t\t\t\t\t\t\tconst y = e.offsetY;\n\t\t\t\t\t\t\tconst dx = e.movementX;\n\t\t\t\t\t\t\tconst dy = e.movementY;\n\n\t\t\t\t\t\t\tif (e.buttons > 0) {\n\t\t\t\t\t\t\t\tthis.ctx.beginPath();\n\t\t\t\t\t\t\t\tthis.ctx.moveTo(x, y);\n\t\t\t\t\t\t\t\tthis.ctx.lineTo(x - dx, y - dy);\n\t\t\t\t\t\t\t\tthis.ctx.stroke();\n\t\t\t\t\t\t\t\tthis.ctx.closePath();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.$refs.crocodileCanvas.onmouseup = this.pictureUpdated;\n\t\t\t\t\tthis.$refs.crocodileCanvas.onmouseleave = this.pictureUpdated;\n\n\t\t\t\t\tthis.$refs.chatForm.addEventListener('submit', (e) => {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tBX.ajax.runAction('hack:crocodile.CrocodileController.uploadMessage', {\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\troomId: this.roomId,\n\t\t\t\t\t\t\t\tuserId: this.userId,\n\t\t\t\t\t\t\t\tmessage: this.message,\n\t\t\t\t\t\t\t\tuserName: this.userName,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthis.message = '';\n\t\t\t\t\t});\n\n\t\t\t\t});\n\t\t\t},\n\t\t\tmethods: {\n\t\t\t\tclearCanvas() {\n\t\t\t\t\tthis.ctx.fillStyle = \"#ffffff\";\n\t\t\t\t\tthis.ctx.rect(0, 0, 800, 600);\n\t\t\t\t\tthis.ctx.fill();\n\t\t\t\t\tthis.pictureUpdated();\n\t\t\t\t},\n\t\t\t\tselectBrush() {\n\t\t\t\t\tthis.tool = 'brush';\n\t\t\t\t\tthis.ctx.strokeStyle = this.color;\n\t\t\t\t\tthis.ctx.lineWidth = 4;\n\t\t\t\t},\n\t\t\t\tselectErase() {\n\t\t\t\t\tthis.tool = 'erase';\n\t\t\t\t\tthis.ctx.strokeStyle = \"#ffffff\";\n\t\t\t\t\tthis.ctx.lineWidth = 16;\n\t\t\t\t},\n\t\t\t\tselectColor(color) {\n\t\t\t\t\tif (this.tool === 'erase')\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tthis.color = color;\n\t\t\t\t\tthis.ctx.strokeStyle = color;\n\t\t\t\t},\n\t\t\t\tselectSize(size) {\n\t\t\t\t\tthis.size = size;\n\t\t\t\t\tthis.ctx.lineWidth = size;\n\t\t\t\t},\n\t\t\t\tpictureUpdated() {\n\t\t\t\t\tif (this.isArtist)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.$refs.crocodileCanvas.toBlob((blob) => {\n\t\t\t\t\t\t\tlet file = new File([blob], \"crocodile.png\", { type: \"image/png\" });\n\t\t\t\t\t\t\tlet formData = new FormData();\n\t\t\t\t\t\t\tformData.append('crocodile.png', file);\n\t\t\t\t\t\t\tfetch('/uploadImage', {method: \"POST\", body: formData})\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tBX.ajax.runAction('hack:crocodile.CrocodileController.pushImage');\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}, 'image/png');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\thandlePullEvent(event) {\n\t\t\t\t\tif (event.command === 'updateImage' && !this.isArtist)\n\t\t\t\t\t{\n\t\t\t\t\t\tfetch('/getCrocodileImage', {method: \"GET\"})\n\t\t\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\t\t\treturn response.json();\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.then((img) => {\n\t\t\t\t\t\t\t\tconst image = new Image();\n\t\t\t\t\t\t\t\timage.onload = () => {\n\t\t\t\t\t\t\t\t\tthis.ctx.drawImage(image, 0, 0);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\timage.src = img;\n\t\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\tif (event.command === 'updateChat')\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.chat.push(event.params);\n\t\t\t\t\t\tthis.$refs.crocodileChat.scrollTop = this.$refs.crocodileChat.scrollHeight;\n\t\t\t\t\t}\n\t\t\t\t\tif (event.command === 'reloadGame')\n\t\t\t\t\t{\n\t\t\t\t\t\tif (this.isArtist)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t}, 1000)\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (event.command === 'gameFinish')\n\t\t\t\t\t{\n\t\t\t\t\t\tconst popup = new Popup(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\twidth: 300,\n\t\t\t\t\t\t\t\theight: 200,\n\t\t\t\t\t\t\t\tcontent: Tag.render`<div>${event.params.winnerName} победил!</div>`,\n\t\t\t\t\t\t\t\tcloseIcon: true,\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\tonClose()\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tdocument.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (this.isArtist)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst canvas = document.createElement('canvas');\n\t\t\t\t\t\t\tconst ctx = canvas.getContext(\"2d\");\n\t\t\t\t\t\t\tctx.fillStyle = \"#ffffff\";\n\t\t\t\t\t\t\tctx.rect(0, 0, 800, 600);\n\t\t\t\t\t\t\tctx.fill();\n\t\t\t\t\t\t\tcanvas.toBlob((blob) => {\n\t\t\t\t\t\t\t\tlet file = new File([blob], \"crocodile.png\", { type: \"image/png\" });\n\t\t\t\t\t\t\t\tlet formData = new FormData();\n\t\t\t\t\t\t\t\tformData.append('crocodile.png', file);\n\t\t\t\t\t\t\t\tfetch('/uploadImage', { method: \"POST\", body: formData });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopup.show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\ttemplate: `\n\t\t\t\t<div class=\"crocodile-container\">\n\t\t\t\t\t<div class=\"artist-panel\" v-if=\"isArtist\">\n\t\t\t\t\t\t<div class=\"panel-row\">\n\t\t\t\t\t\t\t<button @click=\"selectBrush\">Brush</button>\n\t\t\t\t\t\t\t<button @click=\"selectErase\">Erase</button>\n\t\t\t\t\t\t\t<button @click=\"clearCanvas\">Clear all</button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"panel-row\">\n\t\t\t\t\t\t\t<span @click=\"selectColor('black')\" style=\"background: black\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('red')\" style=\"background: red\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('orange')\" style=\"background: orange\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('yellow')\" style=\"background: yellow\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('green')\" style=\"background: green\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('blue')\" style=\"background: blue\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectColor('magenta')\" style=\"background: magenta\" class=\"crocodile-color-select\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"panel-row\">\n\t\t\t\t\t\t\t<span @click=\"selectSize(5)\" :style=\"'width: 5px; background:' + color\" class=\"crocodile-size-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectSize(10)\" :style=\"'width: 10px; background:' + color\" class=\"crocodile-size-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectSize(15)\" :style=\"'width: 15px; background:' + color\" class=\"crocodile-size-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectSize(20)\" :style=\"'width: 20px; background:' + color\" class=\"crocodile-size-select\"></span>\n\t\t\t\t\t\t\t<span @click=\"selectSize(25)\" :style=\"'width: 25px; background:' + color\" class=\"crocodile-size-select\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tool-info\" v-if=\"isArtist\">\n\t\t\t\t\t\t<div class=\"selected-tool\" v-if=\"tool === 'erase'\">\n\t\t\t\t\t\tTool: {{tool}} {{size}}px\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"selected-tool\" v-else>\n\t\t\t\t\t\t\tTool: {{color}} {{tool}} {{size}}px\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"room-info\">\n\t\t\t\t\t\t<div class=\"room-artist\">Художник: {{artistName}}</div>\n\t\t\t\t\t\t<div class=\"room-word\" v-if=\"isArtist\">{{word}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"crocodile-game\">\n\t\t\t\t\t\t<canvas ref=\"crocodileCanvas\" width=\"600\" height=\"400\"></canvas>\n\t\t\t\t\t\t<div class=\"crocodile-chat\">\n\t\t\t\t\t\t\tЧат:\n\t\t\t\t\t\t\t<div ref=\"crocodileChat\" class=\"crocodile-messages\" v-if=\"chat && chat.length !== 0\">\n\t\t\t\t\t\t\t\t<div class=\"message\" v-for=\"msg of chat\">\n\t\t\t\t\t\t\t\t\t<div class=\"message-author\">{{msg.name}}</div>\n\t\t\t\t\t\t\t\t\t<div class=\"message-text\">{{msg.message}}</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<form ref=\"chatForm\" class=\"crocodile-chat-form\" v-if=\"!isArtist\">\n\t\t\t\t\t\t\t\t<input type=\"text\" placeholder=\"Введите сообщение\" class=\"crocodile-input\" v-model=\"message\">\n\t\t\t\t\t\t\t\t<input type=\"submit\" value=\"отправить\">\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`\n\t\t}).mount(this.rootNode);\n\t}\n}\n"],"names":["CrocodileApplication","options","Type","isStringFilled","rootNodeId","rootNode","document","getElementById","Error","attachTemplate","BitrixVue","createApp","data","chat","artistName","roomId","userId","isArtist","word","imagePath","message","tool","color","size","ctx","mounted","BX","PULL","subscribe","type","PullClient","SubscriptionType","Server","moduleId","callback","handlePullEvent","ajax","runAction","then","response","userName","popupWindow","Popup","width","height","content","Tag","render","buttons","PopupWindowButton","text","events","click","close","show","r","$refs","crocodileChat","scrollTop","scrollHeight","crocodileCanvas","getContext","fetch","method","json","img","image","Image","onload","drawImage","src","strokeStyle","lineCap","lineWidth","onmousemove","e","x","offsetX","y","offsetY","dx","movementX","dy","movementY","beginPath","moveTo","lineTo","stroke","closePath","onmouseup","pictureUpdated","onmouseleave","chatForm","addEventListener","preventDefault","methods","clearCanvas","fillStyle","rect","fill","selectBrush","selectErase","selectColor","selectSize","toBlob","blob","file","File","formData","FormData","append","body","event","command","push","params","setTimeout","location","reload","popup","winnerName","closeIcon","onClose","canvas","createElement","template","mount"],"mappings":"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"}